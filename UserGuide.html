<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol.lst-kix_71c113wh6444-4.start{counter-reset:lst-ctn-kix_71c113wh6444-4 0}ol.lst-kix_71c113wh6444-1{list-style-type:none}ol.lst-kix_71c113wh6444-0{list-style-type:none}.lst-kix_71c113wh6444-0>li{counter-increment:lst-ctn-kix_71c113wh6444-0}ol.lst-kix_71c113wh6444-3{list-style-type:none}ol.lst-kix_71c113wh6444-2{list-style-type:none}ol.lst-kix_71c113wh6444-5{list-style-type:none}ol.lst-kix_71c113wh6444-4{list-style-type:none}ol.lst-kix_71c113wh6444-7{list-style-type:none}ol.lst-kix_71c113wh6444-6{list-style-type:none}ol.lst-kix_71c113wh6444-8{list-style-type:none}ol.lst-kix_71c113wh6444-1.start{counter-reset:lst-ctn-kix_71c113wh6444-1 0}ol.lst-kix_71c113wh6444-6.start{counter-reset:lst-ctn-kix_71c113wh6444-6 0}.lst-kix_71c113wh6444-6>li{counter-increment:lst-ctn-kix_71c113wh6444-6}.lst-kix_71c113wh6444-3>li{counter-increment:lst-ctn-kix_71c113wh6444-3}.lst-kix_71c113wh6444-3>li:before{content:"" counter(lst-ctn-kix_71c113wh6444-3,decimal) ". "}.lst-kix_71c113wh6444-2>li:before{content:"" counter(lst-ctn-kix_71c113wh6444-2,lower-roman) ". "}.lst-kix_71c113wh6444-4>li:before{content:"" counter(lst-ctn-kix_71c113wh6444-4,lower-latin) ". "}.lst-kix_71c113wh6444-1>li{counter-increment:lst-ctn-kix_71c113wh6444-1}.lst-kix_71c113wh6444-7>li:before{content:"" counter(lst-ctn-kix_71c113wh6444-7,lower-latin) ". "}.lst-kix_71c113wh6444-0>li:before{content:"" counter(lst-ctn-kix_71c113wh6444-0,decimal) ". "}.lst-kix_71c113wh6444-8>li:before{content:"" counter(lst-ctn-kix_71c113wh6444-8,lower-roman) ". "}.lst-kix_71c113wh6444-4>li{counter-increment:lst-ctn-kix_71c113wh6444-4}.lst-kix_71c113wh6444-1>li:before{content:"" counter(lst-ctn-kix_71c113wh6444-1,lower-latin) ". "}ol.lst-kix_71c113wh6444-3.start{counter-reset:lst-ctn-kix_71c113wh6444-3 0}ol.lst-kix_71c113wh6444-8.start{counter-reset:lst-ctn-kix_71c113wh6444-8 0}.lst-kix_71c113wh6444-7>li{counter-increment:lst-ctn-kix_71c113wh6444-7}ol.lst-kix_71c113wh6444-7.start{counter-reset:lst-ctn-kix_71c113wh6444-7 0}.lst-kix_71c113wh6444-2>li{counter-increment:lst-ctn-kix_71c113wh6444-2}.lst-kix_71c113wh6444-8>li{counter-increment:lst-ctn-kix_71c113wh6444-8}ol.lst-kix_71c113wh6444-2.start{counter-reset:lst-ctn-kix_71c113wh6444-2 0}ol.lst-kix_71c113wh6444-0.start{counter-reset:lst-ctn-kix_71c113wh6444-0 0}.lst-kix_71c113wh6444-5>li{counter-increment:lst-ctn-kix_71c113wh6444-5}.lst-kix_71c113wh6444-6>li:before{content:"" counter(lst-ctn-kix_71c113wh6444-6,decimal) ". "}ol.lst-kix_71c113wh6444-5.start{counter-reset:lst-ctn-kix_71c113wh6444-5 0}.lst-kix_71c113wh6444-5>li:before{content:"" counter(lst-ctn-kix_71c113wh6444-5,lower-roman) ". "}ol{margin:0;padding:0}table td,table th{padding:0}.c0{orphans:2;widows:2;height:11pt}.c8{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c2{orphans:2;widows:2}.c4{margin-left:36pt;padding-left:0pt}.c3{font-size:12pt;font-weight:bold}.c5{font-family:"Arial";color:#000000}.c10{padding:0;margin:0}.c7{font-size:14pt;font-weight:bold}.c1{font-style:italic}.c6{text-decoration:underline}.c11{font-weight:bold}.c9{font-size:11pt}.title{padding-top:24pt;color:#000000;font-weight:bold;font-size:36pt;padding-bottom:6pt;font-family:"Arial";line-height:1.0;page-break-after:avoid;text-align:left}.subtitle{padding-top:18pt;color:#666666;font-size:24pt;padding-bottom:4pt;font-family:"Georgia";line-height:1.0;page-break-after:avoid;font-style:italic;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:32pt;color:#000000;font-weight:bold;font-size:20pt;padding-bottom:18pt;font-family:"Arial";line-height:1.149999976158142;text-align:left}h2{padding-top:29.2pt;color:#000000;font-weight:bold;font-size:16pt;padding-bottom:17.2pt;font-family:"Arial";line-height:1.149999976158142;text-align:left}h3{padding-top:28pt;color:#434343;font-weight:bold;font-size:14pt;padding-bottom:16pt;font-family:"Arial";line-height:1.149999976158142;text-align:left}h4{padding-top:26.8pt;color:#666666;font-weight:bold;font-size:12pt;padding-bottom:16.8pt;font-family:"Arial";line-height:1.149999976158142;text-align:left}h5{padding-top:24.8pt;color:#666666;font-weight:bold;font-size:11pt;padding-bottom:16.8pt;font-family:"Arial";line-height:1.149999976158142;text-align:left}h6{padding-top:30pt;color:#666666;font-weight:bold;font-size:11pt;padding-bottom:22pt;font-family:"Arial";line-height:1.149999976158142;font-style:italic;text-align:left}</style></head><body class="c8"><p class="c2"><span class="c7">Ingame Date &amp; Time</span></p><p class="c0"><span class="c5 c7"></span></p><p class="c2"><span class="c5 c9">This UE4 plugin provides </span><span>functionality for working with calendar dates and times within your game.</span></p><p class="c0"><span></span></p><p class="c2"><span>The idea is to configure a game-internal date system, which can either use the standard calendar or a custom made calendar. You can then schedule Blueprint/C++ timers using dates, times and durations specified in your internal game calendar. This removes the need for constantly converting between real time and game time in your calculations and scripts.</span></p><p class="c0"><span class="c5 c9"></span></p><p class="c2"><span class="c3">Getting Started</span></p><p class="c0"><span class="c3 c5"></span></p><p class="c2"><span>Once the plugin is installed, the classes are immediately available for use.</span></p><p class="c0"><span></span></p><p class="c2"><span>A good starting point is to look at the examples contained in </span><span class="c1">IngameDateTime Content/Examples</span><span>. To see this, you may need to go to </span><span class="c1">View Options</span><span>&nbsp;in the content browser and enable </span><span class="c1">Show Plugin Content</span><span>.</span></p><p class="c0"><span></span></p><p class="c2"><span>Note: the following is an overview of the available functionality. In many cases a more detailed explanation of a function will be given by its tooltip in the blueprint editor. All functions are tagged with the category &lsquo;Ingame Date &amp; Time&rsquo;, so right clicking on a blueprint graph, unchecking </span><span class="c1">Context Sensitive</span><span>, and typing in &lsquo;Ingame&rsquo; is a good way to see what is available and find the associated tooltip explanations.</span></p><p class="c0"><span></span></p><p class="c2"><span class="c3">Examples</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span>Two example calendars are included, each with their own basic demo map.</span></p><p class="c0"><span></span></p><p class="c2"><span>Both demos share a UI designed to showcase the functionality of the plugin, so you can modify the realtime clock rate, load/save clock state, and enter timed message events specified using the ingame calendar. Of course, in practice, you will generally be interfacing with the system from your blueprints/code rather than providing a UI.</span></p><p class="c0"><span></span></p><p class="c2"><span>The examples also show how to create UMG widgets for displaying the time.</span></p><p class="c0"><span></span></p><p class="c2"><span class="c6">Gregorian</span></p><p class="c2"><span>This example uses the standard calendar. It has a simple level set up with a directional light for the sun, a sky sphere, and a pole casting a shadow over a landscape. The blueprints in the </span><span class="c1">LevelEntities/SunSource</span><span>&nbsp;folder give an example of how the clock can be hooked up to a visual time of day system.</span></p><p class="c0"><span></span></p><p class="c2"><span class="c6">Stardate</span></p><p class="c2"><span>This demonstrates use of a custom-defined calendar. In this case, we have year, day (200 days in a year), hour (26), minute (60), second (60).</span></p><p class="c0"><span></span></p><p class="c2"><span class="c3">Setting up your calendar and clock</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span>The basic setup steps are as follows:</span></p><p class="c0"><span></span></p><ol class="c10 lst-kix_71c113wh6444-0 start" start="1"><li class="c2 c4"><span>Create a blueprint, based on either </span><span class="c1">GregorianCalendar</span><span>&nbsp;(for a standard calendar) or </span><span class="c1">FixedPeriodCalendar</span><span>&nbsp;(for a custom calendar)</span><span>. Configure properties as desired. (Note: the plugin class </span><span class="c1">GregorianCalendar</span><span>&nbsp;can in fact be used as-is, however I recommend always creating your own blueprint based on the C++ class, in case you later want to adjust some properties).</span></li><li class="c2 c4"><span>Create a blueprint based on </span><span class="c1">IngameClock</span><span>, set its </span><span class="c1">Calendar Type</span><span>&nbsp;property to your calendar blueprint. Adjust other properties if desired.</span></li><li class="c2 c4"><span>If you don&rsquo;t already have a custom </span><span class="c1">GameState</span><span>&nbsp;blueprint/class, create one and make sure it is set to be used by your game mode.</span></li><li class="c2 c4"><span>Add an </span><span class="c1">IngameClock</span><span>&nbsp;component to your game state. Set its </span><span class="c1">Clock Class </span><span>property to the clock blueprint you created in step 2.</span></li></ol><p class="c0"><span></span></p><p class="c2"><span>Once that&rsquo;s done, your clock will automatically be initialized at level startup. If you want to set the clock time at that point, you can override the </span><span class="c1">OnInitialized</span><span>&nbsp;event inside your clock blueprint.</span></p><p class="c0"><span></span></p><p class="c2"><span>To access the clock and calendar, use the functions </span><span class="c1">GetGlobalIngameClock</span><span>&nbsp;and </span><span class="c1">GetGlobalIngameCalendar</span><span>. If you have blueprints that need very frequent access, it is better to call these only during </span><span class="c1">BeginPlay</span><span>, and store the result in a variable on your blueprint.</span></p><p class="c0"><span></span></p><p class="c2"><span class="c3">Core concepts</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span class="c6">Date/Time</span></p><p class="c2"><span>A date/time is composed of a value for each time period in a given calendar.</span></p><p class="c0"><span></span></p><p class="c2"><span class="c6">Partial date</span></p><p class="c2"><span>A partial date is used to specify a recurring point in time. For example, Jan 1st, 00:00:00 is a partial date where the year is left unspecified. Likewise, 30:00 is a partial date repeating at half past every hour.</span></p><p class="c0"><span></span></p><p class="c2"><span class="c6">Duration</span></p><p class="c2"><span>A duration represents a period of time, and can only be composed of units of fixed length. For example, in the Gregorian calendar class, durations are some number of days, hours, minutes and seconds. Years and months are not permitted, since they are not of fixed length.</span></p><p class="c0"><span></span></p><p class="c2"><span class="c3">Formatting</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span>There are various functions provided by the calendar classes for formatting times and dates. For maximum flexibility, </span><span class="c1">FormatTimePeriodValue</span><span>&nbsp;can be used to format a string for time periods individually. You can then construct UMG widgets with separate text blocks for each period, allowing different fonts and effects for each part. This is the approach used in the Stardate example - see </span><span class="c1">WBP_StardateComplete:GetYearText/GetDayText</span><span>.</span></p><p class="c0"><span></span></p><p class="c2"><span>A more compact way is to use the </span><span class="c1">FormatTime</span><span>&nbsp;function. You can insert any time period IDs you like into the format string. For example, </span><span class="c1">WBP_StardateComplete:GetTimeText</span><span>&nbsp;passes the following: {Hour|w2|z}:{Minute|w2|z}:{Second|w2|z}.</span></p><p class="c0"><span></span></p><p class="c2"><span>Formatting specifiers can optionally follow the period ID, separated by &lsquo;|&rsquo;s.</span></p><p class="c2"><span>Current options are:</span></p><p class="c2"><span>wx - Fixed width, where x is an integer specifying the width in characters.</span></p><p class="c2"><span>z - Prefix leading zeros rather than spaces to fill out the desired width.</span></p><p class="c0"><span></span></p><p class="c2"><span>There are also functions for formatting durations. </span><span class="c1">FormatDurationSimple</span><span>&nbsp;will use a standardized form, whereas </span><span class="c1">FormatDuration</span><span>&nbsp;behaves like </span><span class="c1">FormatTime</span><span>, accepting a format string specifying which time periods should be used.</span></p><p class="c0"><span class="c11"></span></p><p class="c2"><span class="c3">String input</span></p><p class="c0"><span class="c3"></span></p><p class="c2"><span>When specifying a date/time or duration as a string, the structure depends on what exactly you are specifying (a date, a partial date, or a duration). How you configure the </span><span class="c1">Date Input Separator</span><span>&nbsp;and </span><span class="c1">Duration Input Separator </span><span>properties on your calendar also determine how to format an input string.</span></p><p class="c0"><span></span></p><p class="c2"><span>As an example, the Stardate calendar is setup to accept the following input formats:</span></p><p class="c2"><span>Date/Time: y.d-h:m:s</span></p><p class="c2"><span>Duration: d:h:m:s</span></p><p class="c0"><span></span></p><p class="c2"><span>Not all periods need be specified, but note that dates and durations are treated differently in this case. For example, an input of 1.1 for a date in the Stardate calendar is treated as year 1, day 1, with the smaller units (hours, minutes, seconds) assumed to be zero. On the other hand, a duration input of 1:1 means 1 minute, 1 second. Dates are parsed from the left (most significant unit), durations from the right (least significant unit).</span></p><p class="c0"><span></span></p><p class="c2"><span class="c3">Persistence</span></p><p class="c0"><span></span></p><p class="c2"><span>Adding the state of a clock to a UE4 </span><span class="c1">SaveGame </span><span>object is very easy - see </span><span class="c1">Examples/Common/Saving/BP_ExampleSaveGame</span><span>&nbsp;and </span><span class="c1">Examples/Common/Widgets/WBP_SaveLoad</span><span>.</span></p><p class="c0"><span></span></p><p class="c2"><span>If you need a clock to persist between levels, you will need to grab its state in the same way, and then reload it into the clock in the newly loaded map. Essentially this is the same process as above, except instead of a </span><span class="c1">SaveGame</span><span>&nbsp;object, you would likely want to store the state temporarily on your </span><span class="c1">GameInstance</span><span>.</span></p></body></html>